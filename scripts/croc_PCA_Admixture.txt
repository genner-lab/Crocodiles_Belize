#Script used for analyses of Belize crocodile data generated by ipyrad. 
#The original data is named croc83.vcf and contains 83 individuals and 9884 variants

#Step 1: Remove those variants that are not present in at least 80% of the individuals

vcftools --vcf croc83.vcf --max-missing 0.80 --remove-indels --recode --recode-INFO-all --out Croc83_80.vcf

mv Croc83_80.vcf.recode.vcf Croc83_80.vcf

#Step 2: Conduct a PCA on the remaining 1117 variants

plink --vcf Croc83_80.vcf --double-id --allow-extra-chr --make-bed --pca --out CrocPCA_83_80

#Step 3: Remove the 3 reference individuals from the list

vcftools --remove-indv Index11_DM-Ad_GGTTG --remove-indv Index12_DM-Ad_AAGGA --remove-indv Index02_DM-Ad_TCGAT --vcf Croc83_80.vcf --recode --out Croc80_80.vcf

mv Croc80_80.vcf.recode.vcf Croc80_80.vcf

#PCA the 80 individuals

plink --vcf Croc80_80.vcf --double-id --allow-extra-chr --make-bed --pca --out CrocPCA_80_80

#Prepare the files for ADMIXTURE analysis. Note ADMIXTURE does not accept chromosome names that are not human chromosomes. We will thus just exchange the first column by 0.

awk '{$1=0;print $0}' CrocPCA_80_80.bim > CrocPCA_80_80.bim.tmp

mv CrocPCA_80_80.bim.tmp CrocPCA_80_80.bim

#Conduct the ADMIXTURE analysis.

admixture --cv CrocPCA_80_80.bed 2 > CrocPCA_80_80_Admixture.out

#End of Analyses
